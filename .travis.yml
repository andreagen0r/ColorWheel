sudo: false
language: cpp

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: require
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-7
            - gcc-7
            - cmake
      env:
        - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"

    - os: osx
      osx_image: xcode9.2
      compiler: clang
      env:
        - MATRIX_EVAL="COMPILER=clang++"

before_install:
  - eval "${MATRIX_EVAL}"

install:
  - if [ "${TRAVIS_OS_NAME}" = "linux" ]; then
      export QTV=qt510;
      sudo add-apt-repository --yes ppa:beineri/opt-qt-5.10.1-trusty;
      sudo apt update -qq;
      sudo apt search ${QTV};
      sudo apt install build-essential ${QTV}-meta-minimal/trusty ${QTV}quickcontrols/trusty ${QTV}quickcontrols2/trusty ${QTV}graphicaleffects/trusty ${QTV}svg/trusty ${QTV}scxml/trusty git;
      fi
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then
      brew update > /dev/null;
      brew install qt5;
      chmod -R 755 /usr/local/opt/qt5/*;
      export QTDIR="/usr/local/opt/qt5";
      export PATH="$QTDIR/bin:$PATH";
      fi

script:
  - if [ "${TRAVIS_OS_NAME}" = "linux" ]; then
      source /opt/qt*/bin/qt*-env.sh;
      mkdir build;
      cd build;
      cmake ../src/;
      make;
      fi
  - if [ "${TRAVIS_OS_NAME}" = "osx" ]; then
      mkdir build;
      cd build;
      cmake ../src/;
      make;
      fi